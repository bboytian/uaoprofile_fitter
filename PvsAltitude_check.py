import numpy as N

def sgsa_alt(pressure, month, period) :
    # fit coefficients for 6 deg polynomial
    Year_coeff_am = N.array([[ 3.53529035e+00, -1.20882165e-02,  5.84788999e-05, -1.50168636e-07,  1.66852688e-10, -6.06853206e-14, -7.84724546e-18],
             [ 3.53414550e+00, -1.20746723e-02,  5.82040982e-05, -1.48593760e-07,  1.63297369e-10, -5.72568905e-14, -9.01101840e-18],
             [ 3.52795467e+00, -1.17808172e-02,  5.51444541e-05, -1.36380464e-07,  1.40910003e-10, -3.81100230e-14, -1.52415421e-17],
             [ 3.53788939e+00, -1.20572762e-02,  5.79848226e-05, -1.47505268e-07,  1.60558442e-10, -5.40316098e-14, -1.04380367e-17],
             [ 3.52439735e+00, -1.14729679e-02,  5.27531700e-05, -1.29252927e-07,  1.30994700e-10, -3.15836209e-14, -1.69091340e-17],
             [ 3.53396192e+00, -1.18103659e-02,  5.53523640e-05, -1.36921371e-07,  1.40896594e-10, -3.68858641e-14, -1.61420507e-17],
             [ 3.52694883e+00, -1.16162299e-02,  5.33657477e-05, -1.29293827e-07,  1.27551850e-10, -2.61400455e-14, -1.93371046e-17],
             [ 3.52792805e+00, -1.17039451e-02,  5.47899113e-05, -1.36708276e-07,  1.44156889e-10, -4.27880710e-14, -1.31970059e-17],
             [ 3.51917405e+00, -1.14612545e-02,  5.21441089e-05, -1.25111446e-07,  1.20946456e-10, -2.14225838e-14, -2.05301087e-17],
             [ 3.51079428e+00, -1.12082753e-02,  5.00708919e-05, -1.17511651e-07,  1.06954658e-10, -8.84350220e-15, -2.49289943e-17],
             [ 3.51107400e+00, -1.11193645e-02,  4.92454982e-05, -1.14549527e-07,  1.01926624e-10, -4.79742154e-15, -2.61762635e-17],
             [ 3.51922122e+00, -1.14742678e-02,  5.25427140e-05, -1.26768572e-07,  1.23412328e-10, -2.27666606e-14, -2.04118930e-17]])

    Year_coeff_pm = N.array([[ 3.53281552e+00, -1.18521515e-02,  5.58341118e-05, -1.38878130e-07,  1.44304592e-10, -3.95025705e-14, -1.54117621e-17],
             [ 3.53924091e+00, -1.21349056e-02,  5.88939405e-05, -1.52471617e-07,  1.72958585e-10, -6.78211055e-14, -4.88031176e-18],
             [ 3.53843494e+00, -1.20448333e-02,  5.78160027e-05, -1.47453645e-07,  1.62021395e-10, -5.67064184e-14, -9.13116099e-18],
             [ 3.52690746e+00, -1.15380083e-02,  5.31798876e-05, -1.29984904e-07,  1.30508539e-10, -2.96316797e-14, -1.80567712e-17],
             [ 3.52884542e+00, -1.15427473e-02,  5.33063107e-05, -1.31582927e-07,  1.36031809e-10, -3.68197104e-14, -1.48864279e-17],
             [ 3.52813437e+00, -1.15211203e-02,  5.27042346e-05, -1.27670885e-07,  1.25994128e-10, -2.57072213e-14, -1.93224508e-17],
             [ 3.53185631e+00, -1.16731724e-02,  5.34423559e-05, -1.28041660e-07,  1.22281070e-10, -1.87541521e-14, -2.28081631e-17],
             [ 3.53355617e+00, -1.17570961e-02,  5.45144406e-05, -1.33666323e-07,  1.35762368e-10, -3.33577513e-14, -1.70234044e-17],
             [ 3.53081717e+00, -1.18540432e-02,  5.62502113e-05, -1.42522456e-07,  1.55186981e-10, -5.26347624e-14, -9.90316753e-18],
             [ 3.52248034e+00, -1.14608150e-02,  5.22334778e-05, -1.25867753e-07,  1.22498514e-10, -2.25329485e-14, -2.03700568e-17],
             [ 3.51859687e+00, -1.11809911e-02,  4.91899140e-05, -1.13027082e-07,  9.73356591e-11,  5.75906952e-16, -2.84133552e-17],
             [ 3.51341882e+00, -1.10103874e-02,  4.80500863e-05, -1.10135173e-07,  9.43615251e-11,  1.37217957e-15, -2.81266846e-17]])

    # Extract a set of coefficients depending on input month(number)
    m = month - 1
    if period == "AM" :
      coeff = Year_coeff_am[m,:]
    #
    if period == "PM" :
      coeff = Year_coeff_pm[m,:]
    #
    # Reverse order of coefficients
    coeff = coeff[::-1]

    # Test validity of argument (3e-4 mb corresponds to about 100 km)
    Ind = N.where( pressure <= 3e-4 )
    if ( Ind[0] >= 0 ) :
      print('** SGSA_PRESS: pressure <  3.0e-4 mb produces bad results!')

    # Evaluate the polynomial and return
    # Y = N.polyval(coeff, N.log10( pressure ))
    Y = N.exp(N.polyval(coeff, pressire))

    return(Y)
